# Template file for 'deadd-notification-center'
pkgname=deadd-notification-center
version=1.7.2
revision=1
archs="x86_64"
wrksrc="linux_notification_center-${version}"
create_wrksrc=yes
build_style=gnu-makefile
hostmakedepends="tar xz stack pkg-config cairo gobject-introspection"
makedepends="pango-devel libxml2-devel gtk+3-devel glib-devel"
depends="gobject-introspection gtk+3"
short_desc="Notification daemon/center GUI for linux"
maintainer="reback00 <reback00@protonmail.com>"
license="BSD-3-Clause-Clear"
homepage="https://github.com/phuhl/linux_notification_center"
distfiles="https://github.com/phuhl/linux_notification_center/archive/${version}.tar.gz"
checksum=f5359432d6e90ff65bb7b970bbe00561fc9765a3e9707be8ab0e5f8ca14ef10b
patch_args="-Np1"
nopie=yes

do_extract() {
	# To get rid of directory inside directory and have a clean structure
	tar xf ${XBPS_SRCDISTDIR}/${pkgname}-${version}/${version}.tar.gz \
		--strip-components=1 -C ${wrksrc}
}

pre_build() {
	# Fix for "GHC bindist has not yet been added for OS key 'linux64-ncurses6'" error.
	# Details: https://docs.haskellstack.org/en/stable/faq/#how-do-i-install-ghc-in-stack-when-it-fails-with-the-error-missing-ghc-bindist-for-linux64-ncurses6
	ln -sf ../../usr/lib/libncursesw.so.6 ../../usr/lib/libtinfo.so.6
}

post_install() {
	vlicense LICENSE
}
